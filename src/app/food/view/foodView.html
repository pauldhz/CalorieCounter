<div class="container">
  <div>
    <div class="header">
      <app-food-list-header [label]="'Nom'" [style.width.px]="rowDimensions.nameW"></app-food-list-header>
      <app-food-list-header class="header" [label]="'Protéines'"
                            [style.width.px]="rowDimensions.macroW"></app-food-list-header>
      <app-food-list-header class="header" [label]="'Glucides'"
                            [style.width.px]="rowDimensions.macroW"></app-food-list-header>
      <app-food-list-header class="header" [label]="'Lipides'"
                            [style.width.px]="rowDimensions.macroW"></app-food-list-header>
      <app-food-list-header class="header" [label]="'Calories'"
                            [style.width.px]="rowDimensions.macroW"></app-food-list-header>
    </div>

    <ng-container *ngTemplateOutlet="manualInput"></ng-container>

    <app-search-bar (search)="onSearch($event)"></app-search-bar>
    <div class="food-rows-container">
      @for (food of foodsFiltered(); track food.name) {
        <app-mobile-food-row class="mobile" (clicked)="onFoodRowClicked($event)" style="width: 90%" [food]="food"
                             [dimensions]="rowDimensions" (foodAdded)="onAddFood($event)"></app-mobile-food-row>
        <app-desktop-food-row class="desktop" [food]="food" [dimensions]="rowDimensions"
                              (foodAdded)="onAddFood($event)"></app-desktop-food-row>
      }
    </div>
  </div>
  <div class="desktop preview flex-column">
    <h2>Preview</h2>
    <app-food-preview [foods]="selectedFoods()"
                      (removeAll)="clearPreview()"
                      (foodRemoved)="onRemoveFood($event)"></app-food-preview>
  </div>
</div>

<app-modal-input [isOpen]="modalOpen()" (closed)="modalOpen.set(false)">
  <app-macro-display [food]="editedFood()"></app-macro-display>
  <app-add-food [food]="editedFood()" (foodAdded)="onAddFood($event)"></app-add-food>
</app-modal-input>

<app-bottom-preview [display]="true" class="mobile">
  <div class="preview">
    <h2>Preview</h2>
    <app-food-preview [foods]="selectedFoods()"
                      [mobileStyle]="true"
                      (removeAll)="clearPreview()"
                      (foodRemoved)="onRemoveFood($event)"></app-food-preview>
  </div>
</app-bottom-preview>

<ng-template #manualInput>
  <div>
    <input [formControl]="manualName" class="input" [style.width.px]="rowDimensions.nameW - 10" type="text"
           placeholder="nom"/>
    <input [formControl]="manualProteins" class="input no-spinners" [style.width.px]="rowDimensions.macroW - 10"
           type="number" placeholder="protéines"/>
    <input [formControl]="manualCarbs" class="input no-spinners" [style.width.px]="rowDimensions.macroW - 10"
           type="number" placeholder="glucides"/>
    <input [formControl]="manualFat" class="input no-spinners" [style.width.px]="rowDimensions.macroW - 10"
           type="number" placeholder="lipides"/>
    <input [formControl]="manualCalories" class="input no-spinners" [style.width.px]="rowDimensions.macroW - 10"
           type="number" placeholder="calories"/>
    <input type="number" [formControl]="manualAmount" class="no-spinners specific-amount">
    <input type="text" disabled value="g" class="unit"/>
    <button type="button" (click)="addManualFood()" class="specific-amount-button">ajouter mesure</button>

  </div>
</ng-template>
